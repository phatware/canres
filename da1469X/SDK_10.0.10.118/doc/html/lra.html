<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>SmartSnippets DA1469x SDK: Linear Resonance Actuator application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SmartSnippets DA1469x SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Board&#160;and&#160;Applications&#160;General&#160;Info</span></a></li>
      <li><a href="modules.html"><span>SDK&#160;Architecture</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Linear Resonance Actuator application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Overview</h2>
<p>This application demonstrates the use of the <em>Haptic Driver and Controller</em> HW block together with the overall Haptic Support of the SDK in order to drive a <em>Linear Resonant Actuator</em> (LRA) for providing haptic (vibration) effects. Each haptic effect is produced either by manually setting the amplitude and frequency drive parameters or by playing a haptic waveform pattern (encoded sequences of amplitude &amp; frequency pairs) and, in each case, by potentially applying the <em>Overdrive</em> &amp; <em>Frequency Control</em> efficient drive principles using the <em>Haptics Algorithm Library</em> of the SDK. </p><blockquote class="doxtable">
<p><em>Note</em>: It is only applicable to <em>DA14697/9</em> devices. </p>
</blockquote>
<h2>Usage</h2>
<p>The K1 button of the Development Kit (DK) Pro is used in order to execute various haptic operations in a cyclical order. The effect of each press of the button is described below.</p>
<p>1) System wakes up (if asleep), opens a haptic operating session and plays a <em>heartbeat-like</em> haptic pattern, on the LRA's <em>nominal</em> resonant frequency, with <em>Frequency Control and Overdrive off</em>.</p>
<p>2) Plays the same <em>heartbeat-like</em> haptic pattern as before on the LRA's <em>actual</em> resonant frequency, (<em>Frequency Control on</em>) with <em>Overdrive off</em>. If the button is pressed too quickly and the playback of the previous pattern is still in progress, then the previous pattern is waited to finish before playing the new one.</p>
<p>3) Plays a <em>simple rhythmic</em> haptic pattern on the LRA's <em>actual</em> resonant frequency, in the same drive mode as before (<em>Frequency Control on</em> and <em>Overdrive off</em>). If the button is pressed too quickly and the playback of the previous pattern is still in progress, then the previous playback is stopped, and the new pattern is played right away.</p>
<p>4) Plays a <em>phone-ringing-like</em> haptic pattern on the LRA's <em>actual</em> resonant frequency, with <em>Overdrive On</em>. If the button is pressed too quickly and the playback of the previous pattern is still in progress, then the previous playback is stopped, and the new pattern is played right away.</p>
<p>5) Drives the LRA constantly at <em>170Hz frequency</em> with <em>75% drive (intensity) level</em>, (<em>Frequency Control and Overdrive off</em>). If the button is pressed too quickly and the playback of the previous pattern is still in progress, then the previous playback is stopped.</p>
<p>6) Drives the LRA constantly at its actual resonant frequency with <em>60% drive level</em> (<em>Frequency Control on and Overdrive off</em>).</p>
<p>7) Closes the haptic operating session. System enters sleep mode (as long as there are no other tasks in running state and no Debugger is attached).</p>
<p>The application also redirects I/O (e.g. printf) to SEGGER's Real Time Terminal. To access the terminal, open a telnet terminal to localhost:19021.</p>
<h3>Efficient drive principles</h3>
<h4>Frequency Control</h4>
<p>The drive frequency is adjusted automatically so that it constantly matches the LRA's resonant frequency.</p>
<h4>Overdrive</h4>
<p>The drive level is adjusted automatically in order to reach a specified "target" (desired) vibration intensity level in minimum time (by actually "accelerating" and "braking" the LRA and thus leading to <em>sharper</em> haptic effects).</p>
<h2>Setup</h2>
<p>The LRA should be connected to the <em>HDRVP</em> and <em>HDRVM</em> pins (Haptic Driver output) of the device (accessible through the J10 header of the DK Pro). </p><blockquote class="doxtable">
<p><em>Note</em>: The actual two pins of the header may differ among different DK revisions. </p>
</blockquote>
<h2>Configuration</h2>
<h3>Actuator characteristics</h3>
<p>The characteristics of the LRA should be specified in the respective configuration macros, in <code>platform_devices.h</code></p>
<table class="doxtable">
<tr>
<th>Parameter </th><th>Description  </th></tr>
<tr>
<td>LRA_FREQUENCY </td><td>Nominal resonant frequency (in Hz) </td></tr>
<tr>
<td>LRA_MIN_FREQ </td><td>Lower limit for the resonant frequency (in Hz) </td></tr>
<tr>
<td>LRA_MAX_FREQ </td><td>Maximum limit for the resonant frequency (in Hz) </td></tr>
<tr>
<td>LRA_MAX_ABS_V </td><td>Absolute maximum voltage (steady state operation) (in mV) </td></tr>
<tr>
<td>LRA_MAX_NOM_V </td><td>Nominal maximum voltage (transient while changing vibration levels) (in mV) </td></tr>
<tr>
<td>LRA_R </td><td>Impedance (in Ohms) </td></tr>
</table>
<p>They are needed for calculating the appropriate configuration parameters for initializing the Haptic Driver/Controller.</p>
<p>The characteristics of the four following example LRA motors are already provided:</p>
<ul>
<li>JHV10L5L00SB</li>
<li>LVM61530B</li>
<li>LVM61930B</li>
<li>G0825001</li>
</ul>
<p>In case one of these four is used, then only the <code>LRA_MOTOR</code> macro needs to be set to the respective value.</p>
<h3>Haptics Algorithm Library parameters</h3>
<p>The Haptics Algorithm Library configuration parameters, should also be specified:</p>
<table class="doxtable">
<tr>
<th>Parameter </th><th>Description  </th></tr>
<tr>
<td>HL_I_DATA_THRESHOLD </td><td>Threshold for i-data validity </td></tr>
<tr>
<td>HL_CURVE_FITTER_AMP_THRESH </td><td>I-data amplitude threshold for Curve fitter </td></tr>
<tr>
<td>HL_LRA_AFC_ZETA </td><td>AFC damping factor </td></tr>
<tr>
<td>HL_SMART_DRIVE_APPLY </td><td>Apply SmartDrive algorithm </td></tr>
<tr>
<td>HL_SMART_DRIVE_UPDATE </td><td>Update SmartDrive algorithm </td></tr>
<tr>
<td>HL_SMART_DRIVE_PEAK_AMP </td><td>Peak expected back EMF amplitude* </td></tr>
<tr>
<td>HL_SMART_DRIVE_TAU </td><td>Mechanical time constant* </td></tr>
<tr>
<td>HL_SMART_DRIVE_LAMBDA </td><td>RLS forgetting factor </td></tr>
<tr>
<td>HL_SMART_DRIVE_DELTA </td><td>RLS matrix initialization parameter </td></tr>
</table>
<p>*For optimum Overdrive operation, it should be set according to the LRA in use.</p>
<p>More details can be found in the Haptics Algorithm Library <a class="el" href="haptics_lib.html">documentation</a>.</p>
<h3>Waveform Memory parameters</h3>
<p>The waveform timebase should be specified, in <code>platform_devices.h</code>:</p>
<table class="doxtable">
<tr>
<th>Parameter </th><th>Description  </th></tr>
<tr>
<td>WM_TIMEBASE </td><td>Waveform sequence timebase: false: 5.44ms, true: 1.36ms </td></tr>
</table>
<p>The waveform memory data (<code>wm_data</code>), containing the haptic waveform patterns should be specified in <code>waveform_memory.c</code>.</p>
<p>More details can be found in the Waveform Memory Decoder <a class="el" href="wm_decoder.html">documentation</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 7 2020 07:10:51 for SmartSnippets DA1469x SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
